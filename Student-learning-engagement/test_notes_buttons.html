<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Notes Buttons</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .card {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .btn {
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-8">
                <h2>Test Resource Content</h2>
                <p>This is a test resource for testing the notes functionality.</p>
            </div>
            
            <div class="col-lg-4">
                <div class="card sticky-top shadow-lg" style="top: 20px; border: none; border-radius: 15px;">
                    <div class="card-header bg-gradient-primary text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px 15px 0 0; border: none;">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 fw-bold">
                                <i class="fas fa-sticky-note me-2"></i>Study Notes
                            </h5>
                            <div class="d-flex gap-2">
                                <button id="saveNotesBtn" type="button" class="btn btn-sm btn-light text-primary fw-bold" style="border-radius: 20px;">
                                    <i class="fas fa-save me-1"></i>Save
                                </button>
                                <button id="clearNotesBtn" type="button" class="btn btn-sm btn-outline-light" style="border-radius: 20px;">
                                    <i class="fas fa-trash me-1"></i>Clear
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-4" style="background: #f8f9fa;">
                        <!-- Enhanced Info Alert -->
                        <div class="alert alert-info border-0 mb-4" style="background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%); border-radius: 12px;">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-lightbulb text-warning me-3 mt-1" style="font-size: 1.2rem;"></i>
                                <div>
                                    <h6 class="alert-heading mb-2 fw-bold">Smart Note-Taking</h6>
                                    <small class="mb-0">
                                        Your notes auto-save every 3 seconds. Teachers can view and grade your notes to help you improve.
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- Notes Statistics -->
                        <div class="row mb-3">
                            <div class="col-6">
                                <div class="text-center p-2 bg-white rounded-3 shadow-sm">
                                    <div class="fw-bold text-primary" id="wordCount">0</div>
                                    <small class="text-muted">Words</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center p-2 bg-white rounded-3 shadow-sm">
                                    <div class="fw-bold text-success" id="charCount">0</div>
                                    <small class="text-muted">Characters</small>
                                </div>
                            </div>
                        </div>

                        <!-- Enhanced Textarea -->
                        <div class="position-relative">
                            <textarea id="notesTextarea" class="form-control border-0 shadow-sm" rows="12" 
                                      style="border-radius: 12px; resize: none; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6;"
                                      placeholder="Start typing your notes here...&#10;&#10;ðŸ’¡ Study Tips:&#10;â€¢ Write key concepts and definitions&#10;â€¢ Note important examples or formulas&#10;â€¢ Jot down questions you have&#10;â€¢ Summarize main points&#10;â€¢ Use bullet points for clarity"></textarea>
                            
                            <!-- Floating Action Button for Quick Save -->
                            <button id="quickSaveBtn" type="button" class="btn btn-primary btn-sm position-absolute" 
                                    style="bottom: 10px; right: 10px; border-radius: 50%; width: 40px; height: 40px; display: none;"
                                    title="Quick Save">
                                <i class="fas fa-save"></i>
                            </button>
                        </div>

                        <!-- Enhanced Status Bar -->
                        <div class="mt-3 p-3 bg-white rounded-3 shadow-sm">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="d-flex align-items-center">
                                    <div id="statusIcon" class="me-2">
                                        <i class="fas fa-clock text-muted"></i>
                                    </div>
                                    <span id="notesStatus" class="fw-medium text-muted">Ready to save</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span class="badge bg-light text-dark me-2" id="autoSaveBadge">
                                        <i class="fas fa-magic me-1"></i>Auto-save
                                    </span>
                                    <button id="toggleAutoSave" class="btn btn-sm btn-outline-secondary" style="border-radius: 15px;" title="Toggle Auto-save">
                                        <i class="fas fa-toggle-on text-success"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <small id="notesTimestamp" class="text-muted"></small>
                                <small class="text-muted">
                                    <i class="fas fa-keyboard me-1"></i>Ctrl+S to save
                                </small>
                            </div>
                        </div>

                        <!-- Study Progress Indicator -->
                        <div class="mt-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <small class="fw-medium text-muted">Study Progress</small>
                                <small class="text-muted" id="studyTime">0m</small>
                            </div>
                            <div class="progress" style="height: 6px; border-radius: 10px;">
                                <div id="studyProgress" class="progress-bar bg-gradient-primary" role="progressbar" 
                                     style="width: 0%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); border-radius: 10px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test the button functionality
        console.log("Testing notes functionality...");
        
        // Global variables
        let notesChanged = false;
        let autoSaveTimer = null;
        let isSaving = false;
        let autoSaveEnabled = true;
        let studyStartTime = Date.now();
        let wordCount = 0;
        let charCount = 0;
        
        // Update word and character count
        function updateCounts() {
            const textarea = document.getElementById('notesTextarea');
            if (textarea) {
                const text = textarea.value;
                wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
                charCount = text.length;
                
                const wordCountEl = document.getElementById('wordCount');
                const charCountEl = document.getElementById('charCount');
                
                if (wordCountEl) wordCountEl.textContent = wordCount;
                if (charCountEl) charCountEl.textContent = charCount;
            }
        }
        
        // Update status message
        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('notesStatus');
            const statusIcon = document.getElementById('statusIcon');
            
            if (statusEl) {
                statusEl.textContent = message;
            }
            
            if (statusIcon) {
                const icon = statusIcon.querySelector('i');
                if (icon) {
                    icon.className = `fas ${getStatusIcon(type)}`;
                    icon.className += ` ${getStatusColor(type)}`;
                }
            }
        }
        
        // Get status icon based on type
        function getStatusIcon(type) {
            switch (type) {
                case 'success': return 'fa-check-circle';
                case 'error': return 'fa-exclamation-triangle';
                case 'warning': return 'fa-exclamation-circle';
                case 'saving': return 'fa-spinner fa-spin';
                case 'typing': return 'fa-edit';
                default: return 'fa-clock';
            }
        }
        
        // Get status color based on type
        function getStatusColor(type) {
            switch (type) {
                case 'success': return 'text-success';
                case 'error': return 'text-danger';
                case 'warning': return 'text-warning';
                case 'saving': return 'text-info';
                case 'typing': return 'text-primary';
                default: return 'text-muted';
            }
        }
        
        // Update button states
        function updateButtonStates() {
            const textarea = document.getElementById('notesTextarea');
            const saveBtn = document.getElementById('saveNotesBtn');
            const clearBtn = document.getElementById('clearNotesBtn');
            const quickSaveBtn = document.getElementById('quickSaveBtn');
            
            if (textarea && saveBtn && clearBtn) {
                const hasContent = textarea.value.trim().length > 0;
                
                // Save button - enabled when there's content
                saveBtn.disabled = !hasContent || isSaving;
                if (hasContent && !isSaving && notesChanged) {
                    saveBtn.className = 'btn btn-sm btn-light text-primary fw-bold';
                    saveBtn.style.boxShadow = '0 2px 8px rgba(102, 126, 234, 0.3)';
                } else {
                    saveBtn.className = 'btn btn-sm btn-light text-primary fw-bold';
                    saveBtn.style.boxShadow = 'none';
                }
                
                // Clear button - enabled when there's content
                clearBtn.disabled = !hasContent || isSaving;
                if (hasContent && !isSaving) {
                    clearBtn.className = 'btn btn-sm btn-outline-light';
                    clearBtn.style.borderColor = 'rgba(255, 255, 255, 0.5)';
                } else {
                    clearBtn.className = 'btn btn-sm btn-outline-light';
                    clearBtn.style.borderColor = 'rgba(255, 255, 255, 0.3)';
                }
                
                // Quick save button - show when typing
                if (quickSaveBtn) {
                    if (hasContent && notesChanged && !isSaving) {
                        quickSaveBtn.style.display = 'block';
                        quickSaveBtn.style.animation = 'pulse 2s infinite';
                    } else {
                        quickSaveBtn.style.display = 'none';
                        quickSaveBtn.style.animation = 'none';
                    }
                }
            }
        }
        
        // Test save function
        function testSave() {
            updateStatus('Testing save functionality...', 'saving');
            setTimeout(() => {
                updateStatus('Save test completed!', 'success');
                notesChanged = false;
                updateButtonStates();
            }, 1000);
        }
        
        // Test clear function
        function testClear() {
            if (confirm('Test clear functionality?')) {
                const textarea = document.getElementById('notesTextarea');
                if (textarea) {
                    textarea.value = '';
                    updateCounts();
                    updateStatus('Notes cleared!', 'success');
                    notesChanged = false;
                    updateButtonStates();
                }
            }
        }
        
        // Setup event listeners
        function setupEvents() {
            const textarea = document.getElementById('notesTextarea');
            const saveBtn = document.getElementById('saveNotesBtn');
            const clearBtn = document.getElementById('clearNotesBtn');
            const quickSaveBtn = document.getElementById('quickSaveBtn');
            
            if (textarea) {
                textarea.addEventListener('input', function() {
                    notesChanged = true;
                    updateCounts();
                    updateButtonStates();
                    updateStatus('Typing...', 'typing');
                });
            }
            
            if (saveBtn) {
                saveBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    testSave();
                });
            }
            
            if (clearBtn) {
                clearBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    testClear();
                });
            }
            
            if (quickSaveBtn) {
                quickSaveBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    testSave();
                });
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing test page...');
            setupEvents();
            updateCounts();
            updateButtonStates();
            updateStatus('Test page ready!', 'info');
        });
    </script>
</body>
</html>
